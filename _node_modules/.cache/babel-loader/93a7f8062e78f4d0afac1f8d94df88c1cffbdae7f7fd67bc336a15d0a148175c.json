{"ast":null,"code":"\"use strict\";\n\nvar __importDefault = this && this.__importDefault || function (mod) {\n  return mod && mod.__esModule ? mod : {\n    \"default\": mod\n  };\n};\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.ObjectSchema = void 0;\nconst SchemaError_1 = __importDefault(require(\"../Errors/SchemaError\"));\nconst MappingSchema_1 = __importDefault(require(\"./MappingSchema\"));\nconst ValueSchema_1 = __importDefault(require(\"./ValueSchema\"));\nconst VectorSchema_1 = __importDefault(require(\"./VectorSchema\"));\nfunction buildObjectSchema(objectID, lookup) {\n  const attributes = [];\n  let fields = lookup[objectID];\n  if (typeof fields === 'undefined') {\n    fields = [];\n  }\n  delete lookup[objectID];\n  for (const field of fields) {\n    attributes.push({\n      name: field.name,\n      value: buildValueSchema(field.type, lookup)\n    });\n  }\n  return new MappingSchema_1.default(attributes);\n}\nfunction buildValueSchema(type, lookup) {\n  if (type.endsWith('[]')) {\n    return new VectorSchema_1.default(buildValueSchema(type.substring(0, type.length - 2), lookup));\n  }\n  // not supported by the contract currently\n  if (type.startsWith('object{') && type.endsWith('}')) {\n    const objectID = parseInt(type.substring(7, type.length - 1), 10);\n    if (isNaN(objectID)) {\n      throw new SchemaError_1.default(`invalid type '${type}'`);\n    }\n    return buildObjectSchema(objectID, lookup);\n  }\n  return new ValueSchema_1.default(type);\n}\nfunction ObjectSchema(schema) {\n  const objectLookup = {};\n  for (const schemaObject of schema) {\n    const objectID = typeof schemaObject.parent === 'undefined' ? 0 : schemaObject.parent;\n    if (typeof objectLookup[objectID] === 'undefined') {\n      objectLookup[objectID] = [];\n    }\n    objectLookup[objectID].push(schemaObject);\n  }\n  return buildObjectSchema(0, objectLookup);\n}\nexports.ObjectSchema = ObjectSchema;","map":{"version":3,"names":["__importDefault","mod","__esModule","Object","defineProperty","exports","value","ObjectSchema","SchemaError_1","require","MappingSchema_1","ValueSchema_1","VectorSchema_1","buildObjectSchema","objectID","lookup","attributes","fields","field","push","name","buildValueSchema","type","default","endsWith","substring","length","startsWith","parseInt","isNaN","schema","objectLookup","schemaObject","parent"],"sources":["/Users/germangurov/projects/wax_bot/node_modules/atomicassets/build/Schema/index.js"],"sourcesContent":["\"use strict\";\nvar __importDefault = (this && this.__importDefault) || function (mod) {\n    return (mod && mod.__esModule) ? mod : { \"default\": mod };\n};\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.ObjectSchema = void 0;\nconst SchemaError_1 = __importDefault(require(\"../Errors/SchemaError\"));\nconst MappingSchema_1 = __importDefault(require(\"./MappingSchema\"));\nconst ValueSchema_1 = __importDefault(require(\"./ValueSchema\"));\nconst VectorSchema_1 = __importDefault(require(\"./VectorSchema\"));\nfunction buildObjectSchema(objectID, lookup) {\n    const attributes = [];\n    let fields = lookup[objectID];\n    if (typeof fields === 'undefined') {\n        fields = [];\n    }\n    delete lookup[objectID];\n    for (const field of fields) {\n        attributes.push({ name: field.name, value: buildValueSchema(field.type, lookup) });\n    }\n    return new MappingSchema_1.default(attributes);\n}\nfunction buildValueSchema(type, lookup) {\n    if (type.endsWith('[]')) {\n        return new VectorSchema_1.default(buildValueSchema(type.substring(0, type.length - 2), lookup));\n    }\n    // not supported by the contract currently\n    if (type.startsWith('object{') && type.endsWith('}')) {\n        const objectID = parseInt(type.substring(7, type.length - 1), 10);\n        if (isNaN(objectID)) {\n            throw new SchemaError_1.default(`invalid type '${type}'`);\n        }\n        return buildObjectSchema(objectID, lookup);\n    }\n    return new ValueSchema_1.default(type);\n}\nfunction ObjectSchema(schema) {\n    const objectLookup = {};\n    for (const schemaObject of schema) {\n        const objectID = typeof schemaObject.parent === 'undefined' ? 0 : schemaObject.parent;\n        if (typeof objectLookup[objectID] === 'undefined') {\n            objectLookup[objectID] = [];\n        }\n        objectLookup[objectID].push(schemaObject);\n    }\n    return buildObjectSchema(0, objectLookup);\n}\nexports.ObjectSchema = ObjectSchema;\n"],"mappings":"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"},"metadata":{},"sourceType":"script","externalDependencies":[]}