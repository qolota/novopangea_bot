{"ast":null,"code":"import _regeneratorRuntime from\"/Users/germangurov/projects/wax_bot/node_modules/@babel/runtime/helpers/esm/regeneratorRuntime.js\";import _toConsumableArray from\"/Users/germangurov/projects/wax_bot/node_modules/@babel/runtime/helpers/esm/toConsumableArray.js\";import _asyncToGenerator from\"/Users/germangurov/projects/wax_bot/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";var fetchAllWaxData2=require('../../core/fetchAllWaxData2');var CONTRACTS=require('../consts/CONTRACTS');var convertAllCosts=require('../utils/convertAllCosts');var fetchExchange=require('./fetchExchange');var fetchNovoPrice=require('./fetchNovoPrice');var fetchWorkerConfigs=/*#__PURE__*/function(){var _ref2=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee(_ref){var _ref$cache,cache,exchange,novoPrice,workerConfigs;return _regeneratorRuntime().wrap(function _callee$(_context){while(1)switch(_context.prev=_context.next){case 0:_ref$cache=_ref.cache,cache=_ref$cache===void 0?{}:_ref$cache;_context.t0=cache.exchange;if(_context.t0){_context.next=6;break;}_context.next=5;return fetchExchange();case 5:_context.t0=_context.sent;case 6:exchange=_context.t0;_context.t1=cache.novoPrice;if(_context.t1){_context.next=12;break;}_context.next=11;return fetchNovoPrice();case 11:_context.t1=_context.sent;case 12:novoPrice=_context.t1;_context.next=15;return fetchAllWaxData2({params:{code:CONTRACTS.GAME,scope:CONTRACTS.GAME,table:\"workercfg\"},customProcessor:function customProcessor(_ref3){var row=_ref3.row;return{id:row.id,shiftTime:row.shift_time,restTime:row.rest_time,level:row.level,yieldMultiplier:Number(row.yield_multiplier),wageMultiplier:Number(row.wage_multiplier),shiftCost:convertAllCosts({costs:row.shift_cost,exchange:exchange,novoPrice:novoPrice}),foodCost:convertAllCosts({costs:[row.food_cost],exchange:exchange,novoPrice:novoPrice}),totalShiftCost:convertAllCosts({costs:[].concat(_toConsumableArray(row.shift_cost),[row.food_cost]),exchange:exchange,novoPrice:novoPrice})};}});case 15:workerConfigs=_context.sent;return _context.abrupt(\"return\",workerConfigs);case 17:case\"end\":return _context.stop();}},_callee);}));return function fetchWorkerConfigs(_x){return _ref2.apply(this,arguments);};}();module.exports=fetchWorkerConfigs;","map":{"version":3,"names":["fetchAllWaxData2","require","CONTRACTS","convertAllCosts","fetchExchange","fetchNovoPrice","fetchWorkerConfigs","_ref2","_asyncToGenerator","_regeneratorRuntime","mark","_callee","_ref","_ref$cache","cache","exchange","novoPrice","workerConfigs","wrap","_callee$","_context","prev","next","t0","sent","t1","params","code","GAME","scope","table","customProcessor","_ref3","row","id","shiftTime","shift_time","restTime","rest_time","level","yieldMultiplier","Number","yield_multiplier","wageMultiplier","wage_multiplier","shiftCost","costs","shift_cost","foodCost","food_cost","totalShiftCost","concat","_toConsumableArray","abrupt","stop","_x","apply","arguments","module","exports"],"sources":["/Users/germangurov/projects/wax_bot/src/novopangea/api/fetchWorkerConfigs.js"],"sourcesContent":["const fetchAllWaxData2 = require('../../core/fetchAllWaxData2');\nconst CONTRACTS = require('../consts/CONTRACTS');\nconst convertAllCosts = require('../utils/convertAllCosts');\nconst fetchExchange = require('./fetchExchange');\nconst fetchNovoPrice = require('./fetchNovoPrice');\n\nconst fetchWorkerConfigs = async ({\n    cache = {},\n}) => {\n    const exchange = cache.exchange || await fetchExchange();\n    const novoPrice = cache.novoPrice || await fetchNovoPrice();\n    const workerConfigs = await fetchAllWaxData2({\n        params: {\n            code: CONTRACTS.GAME,\n            scope: CONTRACTS.GAME,\n            table: \"workercfg\",\n        },\n        customProcessor: ({row}) => {\n            return {\n                id: row.id,\n                shiftTime: row.shift_time,\n                restTime: row.rest_time,\n                level: row.level,\n                yieldMultiplier: Number(row.yield_multiplier),\n                wageMultiplier: Number(row.wage_multiplier),\n                shiftCost: convertAllCosts({\n                    costs: row.shift_cost,\n                    exchange,\n                    novoPrice,\n                }),\n                foodCost: convertAllCosts({\n                    costs: [row.food_cost],\n                    exchange,\n                    novoPrice,\n                }),\n                totalShiftCost: convertAllCosts({\n                    costs: [\n                        ...row.shift_cost,\n                        row.food_cost,\n                    ],\n                    exchange,\n                    novoPrice,\n                }),\n            };\n        },\n    });\n\n    return workerConfigs;\n};\n\nmodule.exports = fetchWorkerConfigs;"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}