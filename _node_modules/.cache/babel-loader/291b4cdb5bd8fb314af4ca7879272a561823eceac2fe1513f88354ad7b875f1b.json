{"ast":null,"code":"import _regeneratorRuntime from\"/Users/germangurov/projects/wax_bot/node_modules/@babel/runtime/helpers/esm/regeneratorRuntime.js\";import _asyncToGenerator from\"/Users/germangurov/projects/wax_bot/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";var fetchAllWaxData2=require('../../core/fetchAllWaxData2');var CONTRACTS=require('../consts/CONTRACTS');var fetchExchange=require('./fetchExchange');var fetchNovoPrice=require('./fetchNovoPrice');var convertAllCosts=require('../utils/convertAllCosts');var fetchBuildingConfigs=/*#__PURE__*/function(){var _ref2=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee(_ref){var _ref$cache,cache,exchange,novoPrice,buildingConfigs;return _regeneratorRuntime().wrap(function _callee$(_context){while(1)switch(_context.prev=_context.next){case 0:_ref$cache=_ref.cache,cache=_ref$cache===void 0?{}:_ref$cache;_context.t0=cache.exchange;if(_context.t0){_context.next=6;break;}_context.next=5;return fetchExchange();case 5:_context.t0=_context.sent;case 6:exchange=_context.t0;_context.t1=cache.novoPrice;if(_context.t1){_context.next=12;break;}_context.next=11;return fetchNovoPrice();case 11:_context.t1=_context.sent;case 12:novoPrice=_context.t1;_context.next=15;return fetchAllWaxData2({params:{code:CONTRACTS.GAME,scope:CONTRACTS.GAME,table:\"buildingcfg\"},customProcessor:function customProcessor(_ref3){var row=_ref3.row;return{id:row.id,level:row.level,resourceType:row.resource_type,workerCapacity:row.worker_capacity,restTime:row.rest_time,minimumWage:convertAllCosts({costs:[row.minimum_wage],exchange:exchange,novoPrice:novoPrice}),shiftCost:convertAllCosts({costs:row.shift_cost,exchange:exchange,novoPrice:novoPrice}),shiftYield:convertAllCosts({costs:row.shift_yield,exchange:exchange,novoPrice:novoPrice})};}});case 15:buildingConfigs=_context.sent;return _context.abrupt(\"return\",buildingConfigs);case 17:case\"end\":return _context.stop();}},_callee);}));return function fetchBuildingConfigs(_x){return _ref2.apply(this,arguments);};}();module.exports=fetchBuildingConfigs;","map":{"version":3,"names":["fetchAllWaxData2","require","CONTRACTS","fetchExchange","fetchNovoPrice","convertAllCosts","fetchBuildingConfigs","_ref2","_asyncToGenerator","_regeneratorRuntime","mark","_callee","_ref","_ref$cache","cache","exchange","novoPrice","buildingConfigs","wrap","_callee$","_context","prev","next","t0","sent","t1","params","code","GAME","scope","table","customProcessor","_ref3","row","id","level","resourceType","resource_type","workerCapacity","worker_capacity","restTime","rest_time","minimumWage","costs","minimum_wage","shiftCost","shift_cost","shiftYield","shift_yield","abrupt","stop","_x","apply","arguments","module","exports"],"sources":["/Users/germangurov/projects/wax_bot/src/novopangea/api/fetchBuildingConfigs.js"],"sourcesContent":["const fetchAllWaxData2 = require('../../core/fetchAllWaxData2');\nconst CONTRACTS = require('../consts/CONTRACTS');\nconst fetchExchange = require('./fetchExchange');\nconst fetchNovoPrice = require('./fetchNovoPrice');\nconst convertAllCosts = require('../utils/convertAllCosts');\n\nconst fetchBuildingConfigs = async ({\n    cache = {}\n}) => {\n    const exchange = cache.exchange || await fetchExchange();\n    const novoPrice = cache.novoPrice || await fetchNovoPrice();\n    const buildingConfigs = await fetchAllWaxData2({\n        params: {\n            code: CONTRACTS.GAME,\n            scope: CONTRACTS.GAME,\n            table: \"buildingcfg\",\n        },\n        customProcessor: ({row}) => ({\n            id: row.id,\n            level: row.level,\n            resourceType: row.resource_type,\n            workerCapacity: row.worker_capacity,\n            restTime: row.rest_time,\n            minimumWage: convertAllCosts({\n                costs: [row.minimum_wage],\n                exchange,\n                novoPrice,\n            }),\n            shiftCost: convertAllCosts({\n                costs: row.shift_cost,\n                exchange,\n                novoPrice,\n            }),\n            shiftYield: convertAllCosts({\n                costs: row.shift_yield,\n                exchange,\n                novoPrice,\n            }),\n        }),\n    });\n\n    return buildingConfigs;\n};\n\nmodule.exports = fetchBuildingConfigs;"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}