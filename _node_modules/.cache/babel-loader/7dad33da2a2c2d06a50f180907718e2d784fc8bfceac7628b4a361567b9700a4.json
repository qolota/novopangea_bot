{"ast":null,"code":"const _ = require('lodash');\nconst setBuildWage = require('./actions/setBuildWage');\nconst wakeupWorkers = require('./actions/wakeupWorkers');\nconst multiplyResources = require('./utils/multiplyResources');\nconst sumResources = require('./utils/sumResources');\nconst exchangeTokens = require('./actions/exchangeTokens');\nconst getExchangeRate = require('./utils/getExchangeRate');\nconst RESOURCES = require('./consts/RESOURSES');\nconst MIN_TRANSACTION_VALUE = require('./consts/MIN_TRANSACTION_VALUE');\nconst EXCHANGE_STRATEGY = require('./consts/EXCHANGE_STRATEGY');\nconst findResource = require('./utils/findResource');\nconst startShift = require('./actions/startShift');\nconst {\n  default: log\n} = require('../utils/log');\nconst renewRent = require('./actions/renewRent');\nconst feedOneWorker = require('./actions/feedOneWorker');\nconst stakeBuilding = require('./actions/stakeBuilding');\nconst fetchAllGameData = require('./api/fetchAllGameData');\nconst removeBuilding = require('./actions/removeBuilding');\nconst setLandRent = require('./actions/setLandRent');\nconst startUpgrade = require('./actions/startUpgrade');\nconst finishUpgrade = require('./actions/finishUpgrade');\nconst exchangeResources = require('./utils/exchangeResources');\nconst {\n  getEconomyValues\n} = require('./consts/ECONOMY_VALUES');\nconst findBuildings = ({\n  buildings,\n  realmName,\n  level,\n  buildingSetName\n}) => {\n  return buildings.find(b => b.realmName === realmName).buildings[level - 1][buildingSetName];\n};\nconst findLands = ({\n  lands,\n  realmName,\n  landSetName\n}) => {\n  return lands.find(land => land.realmName === realmName)[landSetName];\n};\n\n// -------------------------------------------------------- //\n// ---------               BALANCE               ---------- //\n// -------------------------------------------------------- //\nconst MAX_OBSD_BALANCE = 20;\nconst getNextStateAfterTransferExcessObsdToNovo = ({\n  prevState,\n  accountName\n}) => {\n  const obsdBalance = findResource({\n    resources: prevState.resources,\n    symbol: RESOURCES.OBSD\n  });\n  if (obsdBalance.value <= MAX_OBSD_BALANCE) {\n    return;\n  }\n  const excessObsResource = {\n    value: _.floor((obsdBalance.value - MAX_OBSD_BALANCE + 3) / MIN_TRANSACTION_VALUE.NOVO) * MIN_TRANSACTION_VALUE.NOVO,\n    symbol: RESOURCES.OBSD\n  };\n  return {\n    action: 'exchange',\n    actions: [exchangeTokens({\n      accountName,\n      valueFrom: excessObsResource.value,\n      symbolFrom: excessObsResource.symbol,\n      symbolTo: RESOURCES.NOVO\n    })],\n    resources: sumResources({\n      resources: [...prevState.resources, {\n        value: -excessObsResource.value,\n        symbol: excessObsResource.symbol\n      }]\n    }),\n    availableWorkers: _.cloneDeep(prevState.availableWorkers),\n    availableBuildings: _.cloneDeep(prevState.availableBuildings),\n    availableLands: _.cloneDeep(prevState.availableLands),\n    settings: _.cloneDeep(prevState.settings)\n  };\n};\nconst getNextStateAfterTransferAllResourecesToObsd = ({\n  prevState,\n  exchange,\n  accountName\n}) => {\n  const restBalances = _([RESOURCES.NOVOE, RESOURCES.NOVOM, RESOURCES.NOVOF]).map(symbol => findResource({\n    resources: prevState.resources,\n    symbol\n  })).value();\n  const hasRestResources = _.some(restBalances, b => {\n    return b.value >= MIN_TRANSACTION_VALUE[b.symbol];\n  });\n  if (!hasRestResources) {\n    return;\n  }\n\n  // convert all resources to OBSD\n  const exchangeRestResources = getExchangeRate({\n    exchange,\n    resources: _(restBalances).map(b => ({\n      value: _.floor(b.value / MIN_TRANSACTION_VALUE[b.symbol]) * MIN_TRANSACTION_VALUE[b.symbol],\n      symbol: b.symbol\n    })).filter(b => b.value > 0).value(),\n    exchangeStrategy: EXCHANGE_STRATEGY\n  });\n  const exchangedObsdBalance = sumResources({\n    resources: _(exchangeRestResources).map(r => ({\n      value: r.valueFrom,\n      symbol: r.symbolFrom\n    })).value()\n  });\n  return {\n    action: 'exchange',\n    actions: _(exchangeRestResources).map(b => exchangeTokens({\n      accountName,\n      valueFrom: b.valueTo,\n      symbolFrom: b.symbolTo,\n      symbolTo: b.symbolFrom\n    })).value(),\n    resources: sumResources({\n      resources: [...prevState.resources, ...exchangedObsdBalance, ..._(exchangeRestResources).map(b => ({\n        value: -b.valueTo,\n        symbol: b.symbolTo\n      })).value()]\n    }),\n    availableWorkers: _.cloneDeep(prevState.availableWorkers),\n    availableBuildings: _.cloneDeep(prevState.availableBuildings),\n    availableLands: _.cloneDeep(prevState.availableLands),\n    settings: _.cloneDeep(prevState.settings)\n  };\n};\n\n// -------------------------------------------------------- //\n// ---------                JOB                  ---------- //\n// -------------------------------------------------------- //\nconst getNextStateAfterOwnShiftStart = ({\n  prevState,\n  accountName,\n  exchange,\n  building,\n  worker,\n  account\n}) => {\n  const totalYield = multiplyResources({\n    resources: building.shiftYield.costs,\n    multiplier: worker.config.yieldMultiplier\n  });\n  const nextState = exchangeResources({\n    accountName,\n    exchange,\n    balances: prevState.resources,\n    maxBalances: account.maxBalances,\n    requestedResources: worker.config.shiftCost.costs\n  });\n  if (nextState.action === 'stop') {\n    return nextState;\n  }\n  return {\n    action: 'start_own_shift',\n    actions: [...nextState.actions, startShift({\n      accountName,\n      assetId: worker.assetId,\n      realmId: building.realmId,\n      districtId: building.districtId,\n      buildingId: building.id\n    })],\n    resources: sumResources({\n      resources: [...nextState.nextBalances, ...totalYield]\n    }),\n    availableWorkers: _.cloneDeep(prevState.availableWorkers),\n    availableBuildings: _.cloneDeep(prevState.availableBuildings)\n  };\n};\nconst getNextStateAfterExternalShiftStart = ({\n  prevState,\n  accountName,\n  building,\n  worker,\n  account // TODO validate max storage capacity\n}) => {\n  return {\n    action: 'start_external_shift',\n    actions: [startShift({\n      accountName,\n      assetId: worker.assetId,\n      realmId: building.realmId,\n      districtId: building.districtId,\n      buildingId: building.id\n    })],\n    resources: sumResources({\n      resources: [...prevState.resources,\n      // total shift wage\n      ...multiplyResources({\n        resources: building.contractWage.costs,\n        multiplier: worker.config.wageMultiplier\n      })]\n    }),\n    availableWorkers: _.cloneDeep(prevState.availableWorkers),\n    availableBuildings: _.cloneDeep(prevState.availableBuildings)\n  };\n};\nconst getNextStateAfterShiftStart = ({\n  prevState,\n  accountName,\n  exchange,\n  account\n}) => {\n  if (prevState.availableWorkers.length === 0) {\n    return;\n  }\n  if (prevState.availableBuildings.length === 0) {\n    return;\n  }\n\n  // find a suitable building for a next worker\n  const _prevState = _.cloneDeep(prevState);\n  const worker = _prevState.availableWorkers.pop();\n  const building = _prevState.availableBuildings.pop();\n  building.numWorkers++;\n  if (building.numWorkers < building.maxWorkers) {\n    _prevState.availableBuildings.push(building);\n  }\n  if (building.isOwnBuilding) {\n    return getNextStateAfterOwnShiftStart({\n      prevState: _prevState,\n      accountName,\n      exchange,\n      building,\n      worker,\n      account\n    });\n  }\n  return getNextStateAfterExternalShiftStart({\n    prevState: _prevState,\n    accountName,\n    building,\n    worker,\n    account\n  });\n};\nconst _prepShiftBuildings = ({\n  accountName,\n  buildings,\n  level\n}) => {\n  const economyValues = getEconomyValues();\n  return _(buildings).map(building => ({\n    id: building.id,\n    realmId: building.district.realm.id,\n    districtId: building.district.id,\n    isOwnBuilding: building.owner === accountName,\n    numWorkers: building.numWorkers,\n    maxWorkers: building.config.workerCapacity,\n    // wage fields for both own and external jobs\n    jobProfitObsd: building.jobProfitObsd,\n    contractWage: building.contractWage,\n    shiftYield: building.config.shiftYield\n  })).filter(building => building.jobProfitObsd > economyValues.JOB_MIN_PROFITS_OBSD[level - 1]).sortBy(building => building.jobProfitObsd).value();\n};\nconst _getStartMixedShiftAction = ({\n  accountName,\n  exchange,\n  account,\n  gameSettings,\n  realm,\n  actionName\n}) => {\n  const states = [{\n    action: 'init',\n    resources: account.balances,\n    availableWorkers: _.cloneDeep(realm.availableWorkers),\n    availableBuildings: _.cloneDeep(realm.availableBuildings)\n  }];\n  while (true) {\n    const prevState = states[states.length - 1];\n    if (prevState.availableWorkers.length === 0) {\n      break;\n    }\n    if (prevState.availableBuildings.length === 0) {\n      break;\n    }\n    const nextStateTransferExcessObsdToNovo = getNextStateAfterTransferExcessObsdToNovo({\n      prevState,\n      accountName\n    });\n    if (nextStateTransferExcessObsdToNovo != null) {\n      states.push(nextStateTransferExcessObsdToNovo);\n      continue;\n    }\n    const nextStateAfterTransferAllResourecesToObsd = getNextStateAfterTransferAllResourecesToObsd({\n      prevState,\n      exchange,\n      accountName\n    });\n    if (nextStateAfterTransferAllResourecesToObsd != null) {\n      states.push(nextStateAfterTransferAllResourecesToObsd);\n      continue;\n    }\n    const nextStateAfterShiftStart = getNextStateAfterShiftStart({\n      prevState,\n      accountName,\n      exchange,\n      account\n    });\n    if (nextStateAfterShiftStart != null) {\n      if (nextStateAfterShiftStart.action === 'stop') {\n        log({\n          project: gameSettings.name,\n          message: nextStateAfterShiftStart.action.message\n        });\n        break;\n      }\n      states.push(nextStateAfterShiftStart);\n    }\n  }\n  const actions = _(states).map(state => state.actions).compact().flatten().value();\n  if (actions.length === 0) {\n    return;\n  }\n  return {\n    action: actionName,\n    isMultipleTransactions: true,\n    actions: _.chunk(actions, 16)\n  };\n};\nconst getStartMixedShiftAction = ({\n  accountName,\n  exchange,\n  account,\n  buildings,\n  workers,\n  gameSettings\n}) => {\n  if (workers.length === 0) {\n    return;\n  }\n  const realms = _(workers).groupBy(worker => worker.level).map((workers, level) => {\n    const _level = Number(level);\n    return _(workers).groupBy(worker => worker.realmName).map((workers, realmName) => ({\n      realmName,\n      level: _level,\n      availableWorkers: workers,\n      availableBuildings: _prepShiftBuildings({\n        accountName,\n        buildings: findBuildings({\n          buildings,\n          realmName,\n          level: _level,\n          buildingSetName: 'bestJobBuildings'\n        }),\n        level: _level\n      })\n    })).value();\n  }).flatten().sortBy(realm => -realm.level).value();\n\n  // processing one realm at once\n  const realm = realms.find(realm => realm.availableBuildings.length > 0);\n  if (realm == null) {\n    log({\n      project: gameSettings.name,\n      message: `[SKILLED] No available job buildings but ${workers.length} available workers`\n    });\n    return null;\n  }\n  return _getStartMixedShiftAction({\n    accountName,\n    exchange,\n    account,\n    gameSettings,\n    realm,\n    actionName: 'start_mixed_shifts'\n  });\n};\nconst getStartMixedUnskilledShiftAction = ({\n  accountName,\n  exchange,\n  account,\n  buildings,\n  workers,\n  gameSettings\n}) => {\n  if (workers.length === 0) {\n    return;\n  }\n  const realm = {\n    availableWorkers: workers,\n    availableBuildings: _prepShiftBuildings({\n      accountName,\n      buildings,\n      level: 1\n    })\n  };\n  // console.log(`[UNSKILLED] Job buildings: `, realm);\n\n  return _getStartMixedShiftAction({\n    accountName,\n    exchange,\n    account,\n    gameSettings,\n    realm,\n    actionName: 'start_mixed_unskilled_shifts'\n  });\n};\n\n// -------------------------------------------------------- //\n// ---------                REST                 ---------- //\n// -------------------------------------------------------- //\nconst getNextStateAfterRestStart = ({\n  prevState,\n  accountName,\n  exchange,\n  account\n}) => {\n  if (prevState.availableWorkers.length === 0) {\n    return;\n  }\n  if (prevState.availableBuildings.length === 0) {\n    return;\n  }\n\n  // find a suitable building for a next worker\n  const availableWorkers = _.cloneDeep(prevState.availableWorkers);\n  const availableBuildings = _.cloneDeep(prevState.availableBuildings);\n  const worker = availableWorkers.pop();\n  const building = availableBuildings.pop();\n  building.numWorkers++;\n  if (building.numWorkers < building.maxWorkers) {\n    availableBuildings.push(building);\n  }\n\n  // calculate total cost depends on rest building ownership\n  let totalCosts;\n  if (building.isOwnBuilding) {\n    totalCosts = sumResources({\n      resources: [...building.shiftCost.costs, ...worker.config.foodCost.costs]\n    });\n  } else {\n    totalCosts = sumResources({\n      resources: [...building.contractWage.costs, ...worker.config.foodCost.costs]\n    });\n  }\n  const nextState = exchangeResources({\n    accountName,\n    exchange,\n    balances: prevState.resources,\n    maxBalances: account.maxBalances,\n    requestedResources: totalCosts\n  });\n  if (nextState.action === 'stop') {\n    return nextState;\n  }\n  return {\n    action: building.isOwnBuilding ? 'start_own_rest' : 'start_external_rest',\n    actions: [...nextState.actions, feedOneWorker({\n      accountName,\n      buildingId: building.id,\n      workerId: worker.id,\n      realmId: building.realmId,\n      districtId: building.districtId\n    })],\n    resources: sumResources({\n      resources: [...nextState.nextBalances]\n    }),\n    availableWorkers,\n    availableBuildings\n  };\n};\nconst _getStartMixedRestAction = ({\n  accountName,\n  exchange,\n  account,\n  gameSettings,\n  realm,\n  actionName\n}) => {\n  const states = [{\n    action: 'init',\n    resources: account.balances,\n    availableWorkers: _.cloneDeep(realm.availableWorkers),\n    availableBuildings: _.cloneDeep(realm.availableBuildings)\n  }];\n  while (true) {\n    const prevState = states[states.length - 1];\n    if (prevState.availableWorkers.length === 0) {\n      break;\n    }\n    if (prevState.availableBuildings.length === 0) {\n      break;\n    }\n    const nextStateTransferExcessObsdToNovo = getNextStateAfterTransferExcessObsdToNovo({\n      prevState,\n      accountName\n    });\n    if (nextStateTransferExcessObsdToNovo != null) {\n      states.push(nextStateTransferExcessObsdToNovo);\n      continue;\n    }\n    const nextStateAfterTransferAllResourecesToObsd = getNextStateAfterTransferAllResourecesToObsd({\n      prevState,\n      exchange,\n      accountName\n    });\n    if (nextStateAfterTransferAllResourecesToObsd != null) {\n      states.push(nextStateAfterTransferAllResourecesToObsd);\n      continue;\n    }\n    const nextStateAfterRestStart = getNextStateAfterRestStart({\n      prevState,\n      accountName,\n      exchange,\n      account\n    });\n    if (nextStateAfterRestStart != null) {\n      if (nextStateAfterRestStart.action === 'stop') {\n        log({\n          project: gameSettings.name,\n          message: nextStateAfterRestStart.action.message\n        });\n        break;\n      }\n      states.push(nextStateAfterRestStart);\n    }\n  }\n  const actions = _(states).map(state => state.actions).compact().flatten().value();\n  if (actions.length === 0) {\n    return;\n  }\n  return {\n    action: actionName,\n    isMultipleTransactions: true,\n    actions: _.chunk(actions, 16)\n  };\n};\nconst _prepRestBuildings = ({\n  accountName,\n  buildings,\n  level\n}) => {\n  const economyValues = getEconomyValues();\n  return _(buildings).map(building => ({\n    id: building.id,\n    realmId: building.district.realm.id,\n    districtId: building.district.id,\n    isOwnBuilding: building.owner === accountName,\n    numWorkers: building.numWorkers,\n    maxWorkers: building.config.workerCapacity,\n    // wage fields for both own and external jobs\n    restCostObsd: building.restCostObsd,\n    contractWage: building.contractWage,\n    shiftCost: building.config.shiftCost\n  })).filter(building => building.restCostObsd < economyValues.REST_MAX_COST_OBSD[level - 1]).sortBy(building => -building.restCostObsd).value();\n};\nconst getStartMixedRestAction = ({\n  accountName,\n  exchange,\n  account,\n  buildings,\n  workers,\n  gameSettings\n}) => {\n  if (workers.length === 0) {\n    return;\n  }\n  const realms = _(workers).groupBy(worker => worker.level).map((workers, level) => {\n    const _level = Number(level);\n    return _(workers).groupBy(worker => worker.district.realm.name).map((workers, realmName) => ({\n      realmName,\n      level: _level,\n      availableWorkers: workers,\n      availableBuildings: _prepRestBuildings({\n        accountName,\n        buildings: findBuildings({\n          buildings,\n          realmName,\n          level: _level,\n          buildingSetName: 'bestRestBuildings'\n        }),\n        level: _level\n      })\n    })).value();\n  }).flatten().sortBy(realm => -realm.level).value();\n\n  // processing one realm at once\n  const realm = realms.find(realm => realm.availableBuildings.length > 0);\n  if (realm == null) {\n    log({\n      project: gameSettings.name,\n      message: `[SKILLED] No available rest buildings but ${workers.length} available workers`\n    });\n    return null;\n  }\n  return _getStartMixedRestAction({\n    accountName,\n    exchange,\n    account,\n    gameSettings,\n    realm,\n    actionName: 'start_mixed_rests'\n  });\n};\nconst getStartMixedUnskilledRestAction = ({\n  accountName,\n  exchange,\n  account,\n  buildings,\n  workers,\n  gameSettings\n}) => {\n  if (workers.length === 0) {\n    return;\n  }\n  const realms = _(workers).groupBy(worker => worker.district.realm.name).map((workers, realmName) => ({\n    realmName,\n    availableWorkers: workers,\n    availableBuildings: _prepRestBuildings({\n      accountName,\n      buildings: findBuildings({\n        buildings,\n        realmName,\n        level: 1,\n        buildingSetName: 'bestUnskilledRestBuildings'\n      }),\n      level: 1\n    })\n  })).value();\n\n  // processing one realm at once\n  const realm = realms.find(realm => realm.availableBuildings.length > 0);\n  if (realm == null) {\n    log({\n      project: gameSettings.name,\n      message: `[UNSKILLED] No available rest buildings but ${workers.length} available workers`\n    });\n    return null;\n  }\n  return _getStartMixedRestAction({\n    accountName,\n    exchange,\n    account,\n    gameSettings,\n    realm,\n    actionName: 'start_mixed_unskilled_rests'\n  });\n};\n\n// -------------------------------------------------------- //\n// ---------                 RENT                ---------- //\n// -------------------------------------------------------- //\nconst getRenewRentAction = ({\n  accountName,\n  exchange,\n  account,\n  buildings,\n  gameSettings\n}) => {\n  if (buildings.length === 0) {\n    return;\n  }\n  const lands = _(buildings).map(building => building.land).value();\n  const totalCosts = sumResources({\n    resources: _(lands).map(land => land.config.plotRentAmount.costs).flatten().value()\n  });\n  const nextState = exchangeResources({\n    accountName,\n    exchange,\n    balances: account.balances,\n    maxBalances: account.maxBalances,\n    requestedResources: totalCosts\n  });\n  if (nextState.action === 'stop') {\n    log({\n      project: gameSettings.name,\n      message: nextState.message\n    });\n    return null;\n  }\n  return {\n    action: 'renew_rent',\n    actions: [...nextState.actions, renewRent({\n      accountName,\n      landIds: _(lands).map(land => land.id).value()\n    })]\n  };\n};\nconst getNextStateAfterRentLandStart = ({\n  prevState,\n  accountName,\n  landConfigs,\n  exchange,\n  account\n}) => {\n  if (prevState.availableBuildings.length === 0) {\n    return;\n  }\n  if (prevState.availableLands.length === 0) {\n    return;\n  }\n\n  // find a suitable building for a next worker\n  const availableBuildings = _.cloneDeep(prevState.availableBuildings);\n  const availableLands = _.cloneDeep(prevState.availableLands);\n  const building = availableBuildings.pop();\n  const land = availableLands.pop();\n  const landConfig = _(landConfigs).sortBy(config => config.rentTime).value()[0];\n\n  // calculate total cost depends on land ownership\n  let totalCosts = [];\n  if (land.isOwnLand) {\n    if (!land.isAvailableForRent) {\n      totalCosts = [...landConfig.plotRentAmount.costs];\n    }\n  } else {\n    totalCosts = [...land.rentCost.costs];\n  }\n  const nextState = exchangeResources({\n    accountName,\n    exchange,\n    balances: prevState.resources,\n    maxBalances: account.maxBalances,\n    requestedResources: totalCosts\n  });\n  if (nextState.action === 'stop') {\n    return nextState;\n  }\n  return {\n    action: land.isOwnLand ? 'start_own_land_rent' : 'start_external_land_rent',\n    actions: _.compact([...nextState.actions, land.isOwnLand && !land.isAvailableForRent ? setLandRent({\n      accountName,\n      id: land.id,\n      rentObsd: 0,\n      isOwnerOccupied: true,\n      landConfigId: landConfig.id\n    }) : null, stakeBuilding({\n      accountName,\n      assetId: building.assetId,\n      realmId: land.realmId,\n      districtId: land.districtId,\n      landId: land.id\n    })]),\n    resources: sumResources({\n      resources: [...nextState.nextBalances]\n    }),\n    availableBuildings,\n    availableLands\n  };\n};\nconst getRentMixedLandsAction = ({\n  accountName,\n  exchange,\n  account,\n  lands,\n  buildings,\n  landConfigs,\n  gameSettings\n}) => {\n  const economyValues = getEconomyValues();\n  const qualifiedBuildings = _(buildings).filter(building => building.level >= economyValues.MIN_RENT_BUILDING_LEVELS[building.config.resourceType]).value();\n  if (qualifiedBuildings.length === 0) {\n    return;\n  }\n  const realms = _(qualifiedBuildings).groupBy(building => building.realmName).map((buildings, realmName) => ({\n    realmName,\n    availableBuildings: buildings,\n    availableLands: _(findLands({\n      lands,\n      realmName,\n      landSetName: 'bestLands'\n    })).map(land => ({\n      id: land.id,\n      realmId: land.district.realm.id,\n      districtId: land.district.id,\n      owner: land.owner,\n      isOwnLand: land.owner === accountName,\n      isAvailableForRent: land.isAvailableForRent,\n      rentPriceObsd: land.rentPriceObsd,\n      rentCost: land.rentCost\n    })).filter(land => land.rentPriceObsd < economyValues.MAX_LAND_RENT_PRICE_OBSD).sortBy(land => -land.rentPriceObsd).value()\n  })).value();\n\n  // process one realm at a time\n  const realm = realms.find(realm => realm.availableLands.length > 0);\n  if (realm == null) {\n    log({\n      project: gameSettings.name,\n      message: `No available lands but ${qualifiedBuildings.length} available buildings: ${qualifiedBuildings.map(b => b.realmName).join(', ')}`\n    });\n    return;\n  }\n  const states = [{\n    action: 'init',\n    resources: account.balances,\n    availableBuildings: _.cloneDeep(realm.availableBuildings),\n    availableLands: _.cloneDeep(realm.availableLands)\n  }];\n  while (true) {\n    const prevState = states[states.length - 1];\n    if (prevState.availableBuildings.length === 0) {\n      break;\n    }\n    if (prevState.availableLands.length === 0) {\n      break;\n    }\n    const nextStateTransferExcessObsdToNovo = getNextStateAfterTransferExcessObsdToNovo({\n      prevState,\n      accountName\n    });\n    if (nextStateTransferExcessObsdToNovo != null) {\n      states.push(nextStateTransferExcessObsdToNovo);\n      continue;\n    }\n    const nextStateAfterTransferAllResourecesToObsd = getNextStateAfterTransferAllResourecesToObsd({\n      prevState,\n      exchange,\n      accountName\n    });\n    if (nextStateAfterTransferAllResourecesToObsd != null) {\n      states.push(nextStateAfterTransferAllResourecesToObsd);\n      continue;\n    }\n    const nextStateAfterRentLandStart = getNextStateAfterRentLandStart({\n      prevState,\n      accountName,\n      exchange,\n      landConfigs,\n      account\n    });\n    if (nextStateAfterRentLandStart != null) {\n      if (nextStateAfterRentLandStart.action === 'stop') {\n        log({\n          project: gameSettings.name,\n          message: nextStateAfterRentLandStart.action.message\n        });\n        break;\n      }\n      states.push(nextStateAfterRentLandStart);\n    }\n  }\n  const actions = _(states).map(state => state.actions).compact().flatten().value();\n  if (actions.length === 0) {\n    return;\n  }\n  return {\n    action: 'rent_mixed_lands',\n    isMultipleTransactions: true,\n    actions: _.chunk(actions, 16)\n  };\n};\n\n// -------------------------------------------------------- //\n// ---------               UPGRADE               ---------- //\n// -------------------------------------------------------- //\n\nconst getNextStateAfterStartWorkerUpgrade = ({\n  prevState,\n  accountName,\n  exchange,\n  account\n}) => {\n  const settings = _.cloneDeep(prevState.settings);\n  const {\n    worker,\n    config\n  } = settings.pop();\n  const nextState = exchangeResources({\n    accountName,\n    exchange,\n    balances: prevState.resources,\n    maxBalances: account.maxBalances,\n    requestedResources: config.upgradeCost.costs\n  });\n  if (nextState.action === 'stop') {\n    return nextState;\n  }\n  return {\n    action: 'upgrading_workers',\n    actions: [...nextState.actions, startUpgrade({\n      accountName,\n      assetId: worker.id\n    })],\n    resources: sumResources({\n      resources: [...nextState.nextBalances]\n    }),\n    settings\n  };\n};\nconst getStartWorkerUpgradesAction = ({\n  account,\n  exchange,\n  accountName,\n  upgradeConfigs,\n  workers,\n  gameSettings\n}) => {\n  if (workers.length === 0) {\n    return;\n  }\n  const settings = _(workers).map(worker => ({\n    worker,\n    config: upgradeConfigs.find(config => config.key === worker.realmName).configs.find(config => config.baseLevel === worker.level)\n  })).value();\n  const states = [{\n    action: 'init',\n    resources: account.balances,\n    settings: _.cloneDeep(settings)\n  }];\n  while (true) {\n    const prevState = states[states.length - 1];\n    if (prevState.settings.length === 0) {\n      break;\n    }\n    const nextStateTransferExcessObsdToNovo = getNextStateAfterTransferExcessObsdToNovo({\n      prevState,\n      accountName\n    });\n    if (nextStateTransferExcessObsdToNovo != null) {\n      states.push(nextStateTransferExcessObsdToNovo);\n      continue;\n    }\n    const nextStateAfterTransferAllResourecesToObsd = getNextStateAfterTransferAllResourecesToObsd({\n      prevState,\n      exchange,\n      accountName\n    });\n    if (nextStateAfterTransferAllResourecesToObsd != null) {\n      states.push(nextStateAfterTransferAllResourecesToObsd);\n      continue;\n    }\n    const nextStateAfterStartWorkerUpgrade = getNextStateAfterStartWorkerUpgrade({\n      prevState,\n      accountName,\n      exchange,\n      account\n    });\n    if (nextStateAfterStartWorkerUpgrade != null) {\n      if (nextStateAfterStartWorkerUpgrade.action === 'stop') {\n        log({\n          project: gameSettings.name,\n          message: nextStateAfterStartWorkerUpgrade.action.message\n        });\n        break;\n      }\n      states.push(nextStateAfterStartWorkerUpgrade);\n    }\n  }\n  const actions = _(states).map(state => state.actions).compact().flatten().value();\n  if (actions.length === 0) {\n    return;\n  }\n  return {\n    action: 'upgrade_workers',\n    isMultipleTransactions: true,\n    actions: _.chunk(actions, 16)\n  };\n};\nconst getFinishUpgradesAction = ({\n  accountName,\n  upgrades\n}) => {\n  const now = Date.now();\n  const finishedUpgrades = _(upgrades).filter(upgrade => upgrade.owner === accountName).filter(upgrade => upgrade.endTime < now).value();\n  if (finishedUpgrades.length === 0) {\n    return;\n  }\n  return {\n    action: 'finish_upgrades',\n    actions: _(finishedUpgrades).map(upgrade => finishUpgrade({\n      accountName,\n      assetId: upgrade.assetId\n    })).value()\n  };\n};\n\n// -------------------------------------------------------- //\n// ---------             ENTRY POIN              ---------- //\n// -------------------------------------------------------- //\nconst playGameCalcNextAction = async ({\n  accountName,\n  gameSettings\n}) => {\n  const economyValues = getEconomyValues();\n  const {\n    exchange,\n    account,\n    accountBuildings,\n    accountWorkers,\n    accountLands,\n    accountTransfers,\n    landConfigs,\n    upgradeConfigs,\n    upgrades\n  } = await fetchAllGameData({\n    accountName\n  });\n\n  // showing alert if some buildings places in district with inappropriate town hall level\n  if (accountBuildings.ownStaleBuildings.length > 0) {\n    const staleRealms = _(accountBuildings.ownStaleBuildings).map(building => building.district.realm.name).uniq().value();\n    log({\n      project: gameSettings.name,\n      message: `[ACTION NEEDED] ${accountBuildings.ownStaleBuildings.length} stale buildings, need to be moved to another district, relams: ${staleRealms.join(', ')}`\n    });\n  }\n\n  // wake up all available workers\n  if (accountWorkers.readyToWakeupWorkers.length > 0) {\n    return {\n      action: 'wakeup',\n      actions: [wakeupWorkers({\n        accountName,\n        workerIds: _(accountWorkers.readyToWakeupWorkers).map(worker => worker.id).value()\n      })]\n    };\n  }\n\n  // set wage for all avaialbe buildings\n  if (accountBuildings.ownBuildingsWithoutWageSet.length > 0) {\n    return {\n      action: 'set_building_wage',\n      actions: _(accountBuildings.ownBuildingsWithoutWageSet).map(b => setBuildWage({\n        accountName,\n        id: b.id,\n        wageObsd: b.config.minimumWage.obsdCost,\n        isOnlyOwnWorkersAllowed: true,\n        minWorkerLevel: 1\n      })).value()\n    };\n  }\n\n  // prolong rent for buildings placed on your lands\n  if (accountBuildings.ownBuildingsExpiredExternalRentSet.length > 0) {\n    return {\n      action: 'cancel_external_rent',\n      actions: _(accountBuildings.ownBuildingsExpiredExternalRentSet).map(building => removeBuilding({\n        accountName,\n        buildingId: building.id\n      })).value()\n    };\n  }\n  const startMixedShiftsAction = getStartMixedShiftAction({\n    accountName,\n    exchange,\n    account,\n    buildings: accountBuildings.buildings,\n    workers: [...accountWorkers.readyToWorkWorkers],\n    gameSettings\n  });\n  const startMixedUnskilledShiftsAction = getStartMixedUnskilledShiftAction({\n    accountName,\n    exchange,\n    account,\n    buildings: accountBuildings.unskilledJobBuildings,\n    workers: accountWorkers.readyToWorkUnskilledWorkers,\n    gameSettings\n  });\n  const startMixedUnskilledRestAction = getStartMixedUnskilledRestAction({\n    accountName,\n    exchange,\n    account,\n    buildings: accountBuildings.buildings,\n    workers: accountWorkers.readyToRestUnskilledWorkers,\n    gameSettings\n  });\n  const startMixedRestsAction = getStartMixedRestAction({\n    accountName,\n    exchange,\n    account,\n    buildings: accountBuildings.buildings,\n    workers: accountWorkers.readyToRestWorkers,\n    gameSettings\n  });\n  const startRenewRentAction = getRenewRentAction({\n    accountName,\n    exchange,\n    account,\n    buildings: accountBuildings.ownBuildingsExpiredRentSet,\n    gameSettings\n  });\n  const rentExternalLandsAction = getRentMixedLandsAction({\n    accountName,\n    exchange,\n    account,\n    lands: accountLands.lands,\n    buildings: accountTransfers.buildings,\n    landConfigs,\n    gameSettings\n  });\n  const startWorkerUpgradesAction = getStartWorkerUpgradesAction({\n    account,\n    exchange,\n    accountName,\n    upgradeConfigs: upgradeConfigs.workers,\n    workers: accountWorkers.readyToUpgradeWorkers,\n    gameSettings\n  });\n  const finishUpgradesAction = getFinishUpgradesAction({\n    accountName,\n    upgrades\n  });\n  console.log(economyValues);\n  if (finishUpgradesAction != null) {\n    return finishUpgradesAction;\n  }\n  if (economyValues.ENABLE_WORKER_UPGRADES && startWorkerUpgradesAction != null) {\n    return startWorkerUpgradesAction;\n  }\n  if (economyValues.ENABLE_RENT_EXTERNAL_LANDS && rentExternalLandsAction != null) {\n    return rentExternalLandsAction;\n  }\n  if (economyValues.ENABLE_REST_SKILLED_WORKERS && startMixedRestsAction != null) {\n    return startMixedRestsAction;\n  }\n  if (economyValues.ENABLE_REST_UNSKILLED_WORKERS && startMixedUnskilledRestAction != null) {\n    return startMixedUnskilledRestAction;\n  }\n  if (economyValues.ENABLE_RENEW_RENT_LANDS && startRenewRentAction != null) {\n    return startRenewRentAction;\n  }\n  if (economyValues.ENABLE_SHIFT_SKILLED_WORKERS && startMixedShiftsAction != null) {\n    return startMixedShiftsAction;\n  }\n  if (economyValues.ENABLE_SHIFT_UNSKILLED_WORKERS && startMixedUnskilledShiftsAction != null) {\n    return startMixedUnskilledShiftsAction;\n  }\n  return {\n    action: 'wait',\n    message: `Nothing to do for ${accountName}`\n  };\n};\nmodule.exports = playGameCalcNextAction;","map":{"version":3,"names":["_","require","setBuildWage","wakeupWorkers","multiplyResources","sumResources","exchangeTokens","getExchangeRate","RESOURCES","MIN_TRANSACTION_VALUE","EXCHANGE_STRATEGY","findResource","startShift","default","log","renewRent","feedOneWorker","stakeBuilding","fetchAllGameData","removeBuilding","setLandRent","startUpgrade","finishUpgrade","exchangeResources","getEconomyValues","findBuildings","buildings","realmName","level","buildingSetName","find","b","findLands","lands","landSetName","land","MAX_OBSD_BALANCE","getNextStateAfterTransferExcessObsdToNovo","prevState","accountName","obsdBalance","resources","symbol","OBSD","value","excessObsResource","floor","NOVO","action","actions","valueFrom","symbolFrom","symbolTo","availableWorkers","cloneDeep","availableBuildings","availableLands","settings","getNextStateAfterTransferAllResourecesToObsd","exchange","restBalances","NOVOE","NOVOM","NOVOF","map","hasRestResources","some","exchangeRestResources","filter","exchangeStrategy","exchangedObsdBalance","r","valueTo","getNextStateAfterOwnShiftStart","building","worker","account","totalYield","shiftYield","costs","multiplier","config","yieldMultiplier","nextState","balances","maxBalances","requestedResources","shiftCost","assetId","realmId","districtId","buildingId","id","nextBalances","getNextStateAfterExternalShiftStart","contractWage","wageMultiplier","getNextStateAfterShiftStart","length","_prevState","pop","numWorkers","maxWorkers","push","isOwnBuilding","_prepShiftBuildings","economyValues","district","realm","owner","workerCapacity","jobProfitObsd","JOB_MIN_PROFITS_OBSD","sortBy","_getStartMixedShiftAction","gameSettings","actionName","states","nextStateTransferExcessObsdToNovo","nextStateAfterTransferAllResourecesToObsd","nextStateAfterShiftStart","project","name","message","state","compact","flatten","isMultipleTransactions","chunk","getStartMixedShiftAction","workers","realms","groupBy","_level","Number","getStartMixedUnskilledShiftAction","getNextStateAfterRestStart","totalCosts","foodCost","workerId","_getStartMixedRestAction","nextStateAfterRestStart","_prepRestBuildings","restCostObsd","REST_MAX_COST_OBSD","getStartMixedRestAction","getStartMixedUnskilledRestAction","getRenewRentAction","plotRentAmount","landIds","getNextStateAfterRentLandStart","landConfigs","landConfig","rentTime","isOwnLand","isAvailableForRent","rentCost","rentObsd","isOwnerOccupied","landConfigId","landId","getRentMixedLandsAction","qualifiedBuildings","MIN_RENT_BUILDING_LEVELS","resourceType","rentPriceObsd","MAX_LAND_RENT_PRICE_OBSD","join","nextStateAfterRentLandStart","getNextStateAfterStartWorkerUpgrade","upgradeCost","getStartWorkerUpgradesAction","upgradeConfigs","key","configs","baseLevel","nextStateAfterStartWorkerUpgrade","getFinishUpgradesAction","upgrades","now","Date","finishedUpgrades","upgrade","endTime","playGameCalcNextAction","accountBuildings","accountWorkers","accountLands","accountTransfers","ownStaleBuildings","staleRealms","uniq","readyToWakeupWorkers","workerIds","ownBuildingsWithoutWageSet","wageObsd","minimumWage","obsdCost","isOnlyOwnWorkersAllowed","minWorkerLevel","ownBuildingsExpiredExternalRentSet","startMixedShiftsAction","readyToWorkWorkers","startMixedUnskilledShiftsAction","unskilledJobBuildings","readyToWorkUnskilledWorkers","startMixedUnskilledRestAction","readyToRestUnskilledWorkers","startMixedRestsAction","readyToRestWorkers","startRenewRentAction","ownBuildingsExpiredRentSet","rentExternalLandsAction","startWorkerUpgradesAction","readyToUpgradeWorkers","finishUpgradesAction","console","ENABLE_WORKER_UPGRADES","ENABLE_RENT_EXTERNAL_LANDS","ENABLE_REST_SKILLED_WORKERS","ENABLE_REST_UNSKILLED_WORKERS","ENABLE_RENEW_RENT_LANDS","ENABLE_SHIFT_SKILLED_WORKERS","ENABLE_SHIFT_UNSKILLED_WORKERS","module","exports"],"sources":["/Users/germangurov/projects/wax_bot/src/novopangea/playGameCalcNextAction.js"],"sourcesContent":["const _ = require('lodash');\nconst setBuildWage = require('./actions/setBuildWage');\nconst wakeupWorkers = require('./actions/wakeupWorkers');\nconst multiplyResources = require('./utils/multiplyResources');\nconst sumResources = require('./utils/sumResources');\nconst exchangeTokens = require('./actions/exchangeTokens');\nconst getExchangeRate = require('./utils/getExchangeRate');\nconst RESOURCES = require('./consts/RESOURSES');\nconst MIN_TRANSACTION_VALUE = require('./consts/MIN_TRANSACTION_VALUE');\nconst EXCHANGE_STRATEGY = require('./consts/EXCHANGE_STRATEGY');\nconst findResource = require('./utils/findResource');\nconst startShift = require('./actions/startShift');\nconst { default: log} = require('../utils/log');\nconst renewRent = require('./actions/renewRent');\nconst feedOneWorker = require('./actions/feedOneWorker');\nconst stakeBuilding = require('./actions/stakeBuilding');\nconst fetchAllGameData = require('./api/fetchAllGameData');\nconst removeBuilding = require('./actions/removeBuilding');\nconst setLandRent = require('./actions/setLandRent');\nconst startUpgrade = require('./actions/startUpgrade');\nconst finishUpgrade = require('./actions/finishUpgrade');\nconst exchangeResources = require('./utils/exchangeResources');\nconst {\n    getEconomyValues,\n} = require('./consts/ECONOMY_VALUES');\n\nconst findBuildings = ({\n    buildings,\n    realmName,\n    level,\n    buildingSetName,\n}) => {\n    return buildings\n        .find(b => b.realmName === realmName)\n        .buildings[level - 1][buildingSetName];\n};\n\nconst findLands = ({\n    lands,\n    realmName,\n    landSetName,\n}) => {\n    return lands.find(land => land.realmName === realmName)[landSetName];\n};\n\n// -------------------------------------------------------- //\n// ---------               BALANCE               ---------- //\n// -------------------------------------------------------- //\nconst MAX_OBSD_BALANCE = 20;\n\nconst getNextStateAfterTransferExcessObsdToNovo = ({\n    prevState,\n    accountName,\n}) => {\n    const obsdBalance = findResource({\n        resources: prevState.resources,\n        symbol: RESOURCES.OBSD,\n    });\n    \n    if (obsdBalance.value <= MAX_OBSD_BALANCE) {\n        return;\n    }\n\n    const excessObsResource = {\n        value: _.floor((obsdBalance.value - MAX_OBSD_BALANCE + 3) / MIN_TRANSACTION_VALUE.NOVO) * MIN_TRANSACTION_VALUE.NOVO,\n        symbol: RESOURCES.OBSD,\n    };\n\n    return {\n        action: 'exchange',\n        actions: [\n            exchangeTokens({\n                accountName,\n                valueFrom: excessObsResource.value,\n                symbolFrom: excessObsResource.symbol,\n                symbolTo: RESOURCES.NOVO,\n            }),\n        ],\n        resources: sumResources({\n            resources: [\n                ...prevState.resources,\n                {\n                    value: -excessObsResource.value,\n                    symbol: excessObsResource.symbol,\n                },\n            ],\n        }),\n        availableWorkers: _.cloneDeep(prevState.availableWorkers),\n        availableBuildings: _.cloneDeep(prevState.availableBuildings),\n        availableLands: _.cloneDeep(prevState.availableLands),\n        settings: _.cloneDeep(prevState.settings),\n    };\n};\n\nconst getNextStateAfterTransferAllResourecesToObsd = ({\n    prevState,\n    exchange,\n    accountName,\n}) => {\n    const restBalances = _([\n        RESOURCES.NOVOE,\n        RESOURCES.NOVOM,\n        RESOURCES.NOVOF,\n    ])\n        .map(symbol => findResource({\n            resources: prevState.resources,\n            symbol,\n        }))\n        .value();\n    const hasRestResources = _.some(restBalances, b => {\n        return b.value >= MIN_TRANSACTION_VALUE[b.symbol];\n    });\n\n    if (!hasRestResources) {\n        return;\n    }\n\n    // convert all resources to OBSD\n    const exchangeRestResources = getExchangeRate({\n        exchange,\n        resources: _(restBalances)\n            .map(b => ({\n                value: _.floor(b.value / MIN_TRANSACTION_VALUE[b.symbol]) * MIN_TRANSACTION_VALUE[b.symbol],\n                symbol: b.symbol,\n            }))\n            .filter(b => b.value > 0)\n            .value(),\n        exchangeStrategy: EXCHANGE_STRATEGY,\n    });\n    const exchangedObsdBalance = sumResources({\n        resources: _(exchangeRestResources)\n            .map(r => ({\n                value: r.valueFrom,\n                symbol: r.symbolFrom,\n            }))\n            .value(),\n    });\n\n    return {\n        action: 'exchange',\n        actions: _(exchangeRestResources)\n            .map(b => exchangeTokens({\n                accountName,\n                valueFrom: b.valueTo,\n                symbolFrom: b.symbolTo,\n                symbolTo: b.symbolFrom,\n            }))\n            .value(),\n        resources: sumResources({\n            resources: [\n                ...prevState.resources,\n                ...exchangedObsdBalance,\n                ..._(exchangeRestResources)\n                    .map(b => ({\n                        value: -b.valueTo,\n                        symbol: b.symbolTo,\n                    }))\n                    .value(),\n            ],\n        }),\n        availableWorkers: _.cloneDeep(prevState.availableWorkers),\n        availableBuildings: _.cloneDeep(prevState.availableBuildings),\n        availableLands: _.cloneDeep(prevState.availableLands),\n        settings: _.cloneDeep(prevState.settings),\n    };\n};\n\n// -------------------------------------------------------- //\n// ---------                JOB                  ---------- //\n// -------------------------------------------------------- //\nconst getNextStateAfterOwnShiftStart = ({\n    prevState,\n    accountName,\n    exchange,\n    building,\n    worker,\n    account,\n}) => {\n    const totalYield = multiplyResources({\n        resources: building.shiftYield.costs,\n        multiplier: worker.config.yieldMultiplier,\n    });\n\n    const nextState = exchangeResources({\n        accountName,\n        exchange,\n        balances: prevState.resources,\n        maxBalances: account.maxBalances,\n        requestedResources: worker.config.shiftCost.costs,\n    });\n\n    if (nextState.action === 'stop') {\n        return nextState;\n    }\n\n    return {\n        action: 'start_own_shift',\n        actions: [\n            ...nextState.actions,\n            startShift({\n                accountName,\n                assetId: worker.assetId,\n                realmId: building.realmId,\n                districtId: building.districtId,\n                buildingId: building.id,\n            }),\n        ],\n        resources: sumResources({\n            resources: [\n                ...nextState.nextBalances,\n                ...totalYield,\n            ],\n        }),\n        availableWorkers: _.cloneDeep(prevState.availableWorkers),\n        availableBuildings: _.cloneDeep(prevState.availableBuildings),\n    };\n};\n\nconst getNextStateAfterExternalShiftStart = ({\n    prevState,\n    accountName,\n    building,\n    worker,\n    account, // TODO validate max storage capacity\n}) => {\n    return {\n        action: 'start_external_shift',\n        actions: [\n            startShift({\n                accountName,\n                assetId: worker.assetId,\n                realmId: building.realmId,\n                districtId: building.districtId,\n                buildingId: building.id,\n            }),\n        ],\n        resources: sumResources({\n            resources: [\n                ...prevState.resources,\n                // total shift wage\n                ...multiplyResources({\n                    resources: building.contractWage.costs,\n                    multiplier: worker.config.wageMultiplier,\n                }),\n            ],\n        }),\n        availableWorkers: _.cloneDeep(prevState.availableWorkers),\n        availableBuildings: _.cloneDeep(prevState.availableBuildings),\n    };\n};\n\nconst getNextStateAfterShiftStart = ({\n    prevState,\n    accountName,\n    exchange,\n    account,\n}) => {\n    if (prevState.availableWorkers.length === 0) {\n        return;\n    }\n\n    if (prevState.availableBuildings.length === 0) {\n        return;\n    }\n\n    // find a suitable building for a next worker\n    const _prevState = _.cloneDeep(prevState);\n    const worker = _prevState.availableWorkers.pop();\n    const building = _prevState.availableBuildings.pop();\n    building.numWorkers++;\n\n    if (building.numWorkers < building.maxWorkers) {\n        _prevState.availableBuildings.push(building);\n    }\n\n    if (building.isOwnBuilding) {\n        return getNextStateAfterOwnShiftStart({\n            prevState: _prevState,\n            accountName,\n            exchange,\n            building,\n            worker,\n            account,\n        });\n    }\n\n    return getNextStateAfterExternalShiftStart({\n        prevState: _prevState,\n        accountName,\n        building,\n        worker,\n        account,\n    });\n};\n\nconst _prepShiftBuildings = ({\n    accountName,\n    buildings,\n    level,\n}) => {\n    const economyValues = getEconomyValues();\n    return _(buildings)\n        .map(building => ({\n            id: building.id,\n            realmId: building.district.realm.id,\n            districtId: building.district.id,\n            isOwnBuilding: building.owner === accountName,\n            numWorkers: building.numWorkers,\n            maxWorkers: building.config.workerCapacity,\n            // wage fields for both own and external jobs\n            jobProfitObsd: building.jobProfitObsd,\n            contractWage: building.contractWage,\n            shiftYield: building.config.shiftYield,\n        }))\n        .filter(building => building.jobProfitObsd > economyValues.JOB_MIN_PROFITS_OBSD[level - 1])\n        .sortBy(building => building.jobProfitObsd)\n        .value();\n};\n\nconst _getStartMixedShiftAction = ({\n    accountName,\n    exchange,\n    account,\n    gameSettings,\n    realm,\n    actionName,\n}) => {\n    const states = [\n        {\n            action: 'init',\n            resources: account.balances,\n            availableWorkers: _.cloneDeep(realm.availableWorkers),\n            availableBuildings: _.cloneDeep(realm.availableBuildings),\n        },\n    ];\n\n    while (true) {\n        const prevState = states[states.length - 1];\n\n        if (prevState.availableWorkers.length === 0) {\n            break;\n        }\n        if (prevState.availableBuildings.length === 0) {\n            break;\n        }\n\n        const nextStateTransferExcessObsdToNovo = getNextStateAfterTransferExcessObsdToNovo({\n            prevState,\n            accountName,\n        });\n\n        if (nextStateTransferExcessObsdToNovo != null) {\n            states.push(nextStateTransferExcessObsdToNovo);\n            continue;\n        }\n\n        const nextStateAfterTransferAllResourecesToObsd = getNextStateAfterTransferAllResourecesToObsd({\n            prevState,\n            exchange,\n            accountName,\n        });\n\n        if (nextStateAfterTransferAllResourecesToObsd != null) {\n            states.push(nextStateAfterTransferAllResourecesToObsd);\n            continue;\n        }\n\n        const nextStateAfterShiftStart = getNextStateAfterShiftStart({\n            prevState,\n            accountName,\n            exchange,\n            account,\n        });\n\n        if (nextStateAfterShiftStart != null) {\n            if (nextStateAfterShiftStart.action === 'stop') {\n                log({\n                    project: gameSettings.name,\n                    message: nextStateAfterShiftStart.action.message,\n                });\n                break;\n            }\n\n            states.push(nextStateAfterShiftStart);\n        }\n    }\n\n    const actions = _(states)\n        .map(state => state.actions)\n        .compact()\n        .flatten()\n        .value();\n    \n    if (actions.length === 0) {\n        return;\n    }\n\n    return {\n        action: actionName,\n        isMultipleTransactions: true,\n        actions: _.chunk(actions, 16),\n    };\n};\n\nconst getStartMixedShiftAction = ({\n    accountName,\n    exchange,\n    account,\n    buildings,\n    workers,\n    gameSettings,\n}) => {\n    if (workers.length === 0) {\n        return;\n    }\n\n    const realms = _(workers)\n        .groupBy(worker => worker.level)\n        .map((workers, level) => {\n            const _level = Number(level);\n            return _(workers)\n                .groupBy(worker => worker.realmName)\n                .map((workers, realmName) => ({\n                    realmName,\n                    level: _level,\n                    availableWorkers: workers,\n                    availableBuildings: _prepShiftBuildings({\n                        accountName,\n                        buildings: findBuildings({\n                            buildings,\n                            realmName,\n                            level: _level,\n                            buildingSetName: 'bestJobBuildings'\n                        }),\n                        level: _level,\n                    }),\n                }))\n                .value();\n        })\n        .flatten()\n        .sortBy(realm => -realm.level)\n        .value();\n\n    // processing one realm at once\n    const realm = realms.find(realm => realm.availableBuildings.length > 0);\n    \n    if (realm == null) {\n        log({\n            project: gameSettings.name,\n            message: `[SKILLED] No available job buildings but ${workers.length} available workers`,\n        });\n        return null;\n    }\n\n    return _getStartMixedShiftAction({\n        accountName,\n        exchange,\n        account,\n        gameSettings,\n        realm,\n        actionName: 'start_mixed_shifts',\n    });\n};\n\nconst getStartMixedUnskilledShiftAction = ({\n    accountName,\n    exchange,\n    account,\n    buildings,\n    workers,\n    gameSettings,\n}) => {\n    if (workers.length === 0) {\n        return;\n    }\n    \n    const realm = {\n        availableWorkers: workers,\n        availableBuildings: _prepShiftBuildings({\n            accountName,\n            buildings,\n            level: 1,\n        }),\n    };\n    // console.log(`[UNSKILLED] Job buildings: `, realm);\n\n    return _getStartMixedShiftAction({\n        accountName,\n        exchange,\n        account,\n        gameSettings,\n        realm,\n        actionName: 'start_mixed_unskilled_shifts',\n    });\n};\n\n// -------------------------------------------------------- //\n// ---------                REST                 ---------- //\n// -------------------------------------------------------- //\nconst getNextStateAfterRestStart = ({\n    prevState,\n    accountName,\n    exchange,\n    account,\n}) => {\n    if (prevState.availableWorkers.length === 0) {\n        return;\n    }\n\n    if (prevState.availableBuildings.length === 0) {\n        return;\n    }\n\n    // find a suitable building for a next worker\n    const availableWorkers = _.cloneDeep(prevState.availableWorkers);\n    const availableBuildings = _.cloneDeep(prevState.availableBuildings);\n    const worker = availableWorkers.pop();\n    const building = availableBuildings.pop();\n    building.numWorkers++;\n\n    if (building.numWorkers < building.maxWorkers) {\n        availableBuildings.push(building);\n    }\n\n    // calculate total cost depends on rest building ownership\n    let totalCosts;\n    if (building.isOwnBuilding) {\n        totalCosts = sumResources({\n            resources: [\n                ...building.shiftCost.costs,\n                ...worker.config.foodCost.costs,\n            ],\n        });\n    } else {\n        totalCosts = sumResources({\n            resources: [\n                ...building.contractWage.costs,\n                ...worker.config.foodCost.costs,\n            ],\n        });\n    }\n\n    const nextState = exchangeResources({\n        accountName,\n        exchange,\n        balances: prevState.resources,\n        maxBalances: account.maxBalances,\n        requestedResources: totalCosts,\n    });\n\n    if (nextState.action === 'stop') {\n        return nextState;\n    }\n\n    return {\n        action: building.isOwnBuilding\n            ? 'start_own_rest'\n            : 'start_external_rest',\n        actions: [\n            ...nextState.actions,\n            feedOneWorker({\n                accountName,\n                buildingId: building.id,\n                workerId: worker.id,\n                realmId: building.realmId,\n                districtId: building.districtId,\n            }),\n        ],\n        resources: sumResources({\n            resources: [\n                ...nextState.nextBalances,\n            ],\n        }),\n        availableWorkers,\n        availableBuildings,\n    };\n};\n\nconst _getStartMixedRestAction = ({\n    accountName,\n    exchange,\n    account,\n    gameSettings,\n    realm,\n    actionName,\n}) => {\n    const states = [\n        {\n            action: 'init',\n            resources: account.balances,\n            availableWorkers: _.cloneDeep(realm.availableWorkers),\n            availableBuildings: _.cloneDeep(realm.availableBuildings),\n        },\n    ];\n\n    while (true) {\n        const prevState = states[states.length - 1];\n\n        if (prevState.availableWorkers.length === 0) {\n            break;\n        }\n        if (prevState.availableBuildings.length === 0) {\n            break;\n        }\n\n        const nextStateTransferExcessObsdToNovo = getNextStateAfterTransferExcessObsdToNovo({\n            prevState,\n            accountName,\n        });\n\n        if (nextStateTransferExcessObsdToNovo != null) {\n            states.push(nextStateTransferExcessObsdToNovo);\n            continue;\n        }\n\n        const nextStateAfterTransferAllResourecesToObsd = getNextStateAfterTransferAllResourecesToObsd({\n            prevState,\n            exchange,\n            accountName,\n        });\n\n        if (nextStateAfterTransferAllResourecesToObsd != null) {\n            states.push(nextStateAfterTransferAllResourecesToObsd);\n            continue;\n        }\n\n        const nextStateAfterRestStart = getNextStateAfterRestStart({\n            prevState,\n            accountName,\n            exchange,\n            account,\n        });\n\n        if (nextStateAfterRestStart != null) {\n            if (nextStateAfterRestStart.action === 'stop') {\n                log({\n                    project: gameSettings.name,\n                    message: nextStateAfterRestStart.action.message,\n                });\n                break;\n            }\n\n            states.push(nextStateAfterRestStart);\n        }\n    }\n\n    const actions = _(states)\n        .map(state => state.actions)\n        .compact()\n        .flatten()\n        .value();\n    \n    if (actions.length === 0) {\n        return;\n    }\n    \n    return {\n        action: actionName,\n        isMultipleTransactions: true,\n        actions: _.chunk(actions, 16),\n    };\n};\n\nconst _prepRestBuildings = ({\n    accountName,\n    buildings,\n    level,\n}) => {\n    const economyValues = getEconomyValues();\n    return _(buildings)\n        .map(building => ({\n            id: building.id,\n            realmId: building.district.realm.id,\n            districtId: building.district.id,\n            isOwnBuilding: building.owner === accountName,\n            numWorkers: building.numWorkers,\n            maxWorkers: building.config.workerCapacity,\n            // wage fields for both own and external jobs\n            restCostObsd: building.restCostObsd,\n            contractWage: building.contractWage,\n            shiftCost: building.config.shiftCost,\n        }))\n        .filter(building => building.restCostObsd < economyValues.REST_MAX_COST_OBSD[level - 1])\n        .sortBy(building => -building.restCostObsd)\n        .value();\n};\n\nconst getStartMixedRestAction = ({\n    accountName,\n    exchange,\n    account,\n    buildings,\n    workers,\n    gameSettings,\n}) => {\n    if (workers.length === 0) {\n        return;\n    }\n\n    const realms = _(workers)\n        .groupBy(worker => worker.level)\n        .map((workers, level) => {\n            const _level = Number(level);\n            return _(workers)\n                .groupBy(worker => worker.district.realm.name)\n                .map((workers, realmName) => ({\n                    realmName,\n                    level: _level,\n                    availableWorkers: workers,\n                    availableBuildings: _prepRestBuildings({\n                        accountName,\n                        buildings: findBuildings({\n                            buildings,\n                            realmName,\n                            level: _level,\n                            buildingSetName: 'bestRestBuildings'\n                        }),\n                        level: _level,\n                    }),\n                }))\n                .value();\n        })\n        .flatten()\n        .sortBy(realm => -realm.level)\n        .value();\n    \n    // processing one realm at once\n    const realm = realms.find(realm => realm.availableBuildings.length > 0);\n    \n    if (realm == null) {\n        log({\n            project: gameSettings.name,\n            message: `[SKILLED] No available rest buildings but ${workers.length} available workers`,\n        });\n        return null;\n    }\n\n    return _getStartMixedRestAction({\n        accountName,\n        exchange,\n        account,\n        gameSettings,\n        realm,\n        actionName: 'start_mixed_rests',\n    });\n};\n\nconst getStartMixedUnskilledRestAction = ({\n    accountName,\n    exchange,\n    account,\n    buildings,\n    workers,\n    gameSettings,\n}) => {\n    if (workers.length === 0) {\n        return;\n    }\n\n    const realms = _(workers)\n        .groupBy(worker => worker.district.realm.name)\n        .map((workers, realmName) => ({\n            realmName,\n            availableWorkers: workers,\n            availableBuildings: _prepRestBuildings({\n                accountName,\n                buildings: findBuildings({\n                    buildings,\n                    realmName,\n                    level: 1,\n                    buildingSetName: 'bestUnskilledRestBuildings'\n                }),\n                level: 1,\n            }),\n        }))\n        .value();\n    \n    // processing one realm at once\n    const realm = realms.find(realm => realm.availableBuildings.length > 0);\n    \n    if (realm == null) {\n        log({\n            project: gameSettings.name,\n            message: `[UNSKILLED] No available rest buildings but ${workers.length} available workers`,\n        });\n        return null;\n    }\n\n    return _getStartMixedRestAction({\n        accountName,\n        exchange,\n        account,\n        gameSettings,\n        realm,\n        actionName: 'start_mixed_unskilled_rests',\n    });\n};\n\n// -------------------------------------------------------- //\n// ---------                 RENT                ---------- //\n// -------------------------------------------------------- //\nconst getRenewRentAction = ({\n    accountName,\n    exchange,\n    account,\n    buildings,\n    gameSettings,\n}) => {\n    if (buildings.length === 0) {\n        return;\n    }\n\n    const lands = _(buildings)\n        .map(building => building.land)\n        .value();\n    \n    const totalCosts = sumResources({\n        resources: _(lands)\n            .map(land => land.config.plotRentAmount.costs)\n            .flatten()\n            .value(),\n    });\n\n    const nextState = exchangeResources({\n        accountName,\n        exchange,\n        balances: account.balances,\n        maxBalances: account.maxBalances,\n        requestedResources: totalCosts,\n    });\n\n    if (nextState.action === 'stop') {\n        log({\n            project: gameSettings.name,\n            message: nextState.message,\n        });\n        return null;\n    }\n\n    return {\n        action: 'renew_rent',\n        actions: [\n            ...nextState.actions,\n            renewRent({\n                accountName,\n                landIds: _(lands)\n                    .map(land => land.id)\n                    .value(),\n            }),\n        ],\n    };\n};\n\nconst getNextStateAfterRentLandStart = ({\n    prevState,\n    accountName,\n    landConfigs,\n    exchange,\n    account,\n}) => {\n    if (prevState.availableBuildings.length === 0) {\n        return;\n    }\n\n    if (prevState.availableLands.length === 0) {\n        return;\n    }\n\n    // find a suitable building for a next worker\n    const availableBuildings = _.cloneDeep(prevState.availableBuildings);\n    const availableLands = _.cloneDeep(prevState.availableLands);\n    const building = availableBuildings.pop();\n    const land = availableLands.pop();\n    const landConfig = _(landConfigs)\n        .sortBy(config => config.rentTime)\n        .value()[0];\n\n    // calculate total cost depends on land ownership\n    let totalCosts = [];\n    if (land.isOwnLand) {\n        if (!land.isAvailableForRent) {\n            totalCosts = [\n                ...landConfig.plotRentAmount.costs,\n            ];\n        }\n    } else {\n        totalCosts = [\n            ...land.rentCost.costs,\n        ];\n    }\n\n    const nextState = exchangeResources({\n        accountName,\n        exchange,\n        balances: prevState.resources,\n        maxBalances: account.maxBalances,\n        requestedResources: totalCosts,\n    });\n\n    if (nextState.action === 'stop') {\n        return nextState;\n    }\n\n    return {\n        action: land.isOwnLand\n            ? 'start_own_land_rent'\n            : 'start_external_land_rent',\n        actions: _.compact([\n            ...nextState.actions,\n            land.isOwnLand && !land.isAvailableForRent\n                ? setLandRent({\n                    accountName,\n                    id: land.id,\n                    rentObsd: 0,\n                    isOwnerOccupied: true,\n                    landConfigId: landConfig.id,\n                })\n                : null,\n            stakeBuilding({\n                accountName,\n                assetId: building.assetId,\n                realmId: land.realmId,\n                districtId: land.districtId,\n                landId: land.id,\n            }),\n        ]),\n        resources: sumResources({\n            resources: [\n                ...nextState.nextBalances,\n            ],\n        }),\n        availableBuildings,\n        availableLands,\n    };\n};\n\nconst getRentMixedLandsAction = ({\n    accountName,\n    exchange,\n    account,\n    lands,\n    buildings,\n    landConfigs,\n    gameSettings,\n}) => {\n    const economyValues = getEconomyValues();\n    const qualifiedBuildings = _(buildings)\n        .filter(building => building.level >= economyValues.MIN_RENT_BUILDING_LEVELS[building.config.resourceType])\n        .value();\n\n    if (qualifiedBuildings.length === 0) {\n        return;\n    }\n\n    const realms = _(qualifiedBuildings)\n        .groupBy(building => building.realmName)\n        .map((buildings, realmName) => ({\n            realmName,\n            availableBuildings: buildings,\n            availableLands: _(findLands({\n                lands,\n                realmName,\n                landSetName: 'bestLands',\n            }))\n                .map(land => ({\n                    id: land.id,\n                    realmId: land.district.realm.id,\n                    districtId: land.district.id,\n                    owner: land.owner,\n                    isOwnLand: land.owner === accountName,\n                    isAvailableForRent: land.isAvailableForRent,\n                    rentPriceObsd: land.rentPriceObsd,\n                    rentCost: land.rentCost,\n                }))\n                .filter(land => land.rentPriceObsd < economyValues.MAX_LAND_RENT_PRICE_OBSD)\n                .sortBy(land => -land.rentPriceObsd)\n                .value(),\n        }))\n        .value();\n\n    // process one realm at a time\n    const realm = realms.find(realm => realm.availableLands.length > 0);\n\n    if (realm == null) {\n        log({\n            project: gameSettings.name,\n            message: `No available lands but ${qualifiedBuildings.length} available buildings: ${qualifiedBuildings.map(b => b.realmName).join(', ')}`,\n        });\n        return;\n    }\n\n    const states = [\n        {\n            action: 'init',\n            resources: account.balances,\n            availableBuildings: _.cloneDeep(realm.availableBuildings),\n            availableLands: _.cloneDeep(realm.availableLands),\n        },\n    ];\n\n    while (true) {\n        const prevState = states[states.length - 1];\n\n        if (prevState.availableBuildings.length === 0) {\n            break;\n        }\n        if (prevState.availableLands.length === 0) {\n            break;\n        }\n\n        const nextStateTransferExcessObsdToNovo = getNextStateAfterTransferExcessObsdToNovo({\n            prevState,\n            accountName,\n        });\n\n        if (nextStateTransferExcessObsdToNovo != null) {\n            states.push(nextStateTransferExcessObsdToNovo);\n            continue;\n        }\n\n        const nextStateAfterTransferAllResourecesToObsd = getNextStateAfterTransferAllResourecesToObsd({\n            prevState,\n            exchange,\n            accountName,\n        });\n\n        if (nextStateAfterTransferAllResourecesToObsd != null) {\n            states.push(nextStateAfterTransferAllResourecesToObsd);\n            continue;\n        }\n\n        const nextStateAfterRentLandStart = getNextStateAfterRentLandStart({\n            prevState,\n            accountName,\n            exchange,\n            landConfigs,\n            account,\n        });\n\n        if (nextStateAfterRentLandStart != null) {\n            if (nextStateAfterRentLandStart.action === 'stop') {\n                log({\n                    project: gameSettings.name,\n                    message: nextStateAfterRentLandStart.action.message,\n                });\n                break;\n            }\n\n            states.push(nextStateAfterRentLandStart);\n        }\n    }\n\n    const actions = _(states)\n        .map(state => state.actions)\n        .compact()\n        .flatten()\n        .value();\n\n    if (actions.length === 0) {\n        return;\n    }\n\n    return {\n        action: 'rent_mixed_lands',\n        isMultipleTransactions: true,\n        actions: _.chunk(actions, 16),\n    };\n};\n\n// -------------------------------------------------------- //\n// ---------               UPGRADE               ---------- //\n// -------------------------------------------------------- //\n\nconst getNextStateAfterStartWorkerUpgrade = ({\n    prevState,\n    accountName,\n    exchange,\n    account,\n}) => {\n    const settings = _.cloneDeep(prevState.settings);\n    const {\n        worker,\n        config,\n    } = settings.pop();\n\n    const nextState = exchangeResources({\n        accountName,\n        exchange,\n        balances: prevState.resources,\n        maxBalances: account.maxBalances,\n        requestedResources: config.upgradeCost.costs,\n    });\n\n    if (nextState.action === 'stop') {\n        return nextState;\n    }\n\n    return {\n        action: 'upgrading_workers',\n        actions: [\n            ...nextState.actions,\n            startUpgrade({\n                accountName,\n                assetId: worker.id,\n            }),\n        ],\n        resources: sumResources({\n            resources: [\n                ...nextState.nextBalances,\n            ],\n        }),\n        settings,\n    };\n};\n\nconst getStartWorkerUpgradesAction = ({\n    account,\n    exchange,\n    accountName,\n    upgradeConfigs,\n    workers,\n    gameSettings,\n}) => {\n    if (workers.length === 0) {\n        return;\n    }\n\n    const settings = _(workers)\n        .map(worker => ({\n            worker,\n            config: upgradeConfigs\n                .find(config => config.key === worker.realmName)\n                .configs\n                .find(config => config.baseLevel === worker.level),\n        }))\n        .value();\n\n    const states = [\n        {\n            action: 'init',\n            resources: account.balances,\n            settings: _.cloneDeep(settings),\n        },\n    ];\n\n    while(true) {\n        const prevState = states[states.length - 1];\n\n        if (prevState.settings.length === 0) {\n            break;\n        }\n\n        const nextStateTransferExcessObsdToNovo = getNextStateAfterTransferExcessObsdToNovo({\n            prevState,\n            accountName,\n        });\n\n        if (nextStateTransferExcessObsdToNovo != null) {\n            states.push(nextStateTransferExcessObsdToNovo);\n            continue;\n        }\n\n        const nextStateAfterTransferAllResourecesToObsd = getNextStateAfterTransferAllResourecesToObsd({\n            prevState,\n            exchange,\n            accountName,\n        });\n\n        if (nextStateAfterTransferAllResourecesToObsd != null) {\n            states.push(nextStateAfterTransferAllResourecesToObsd);\n            continue;\n        }\n\n        const nextStateAfterStartWorkerUpgrade = getNextStateAfterStartWorkerUpgrade({\n            prevState,\n            accountName,\n            exchange,\n            account,\n        });\n\n        if (nextStateAfterStartWorkerUpgrade != null) {\n            if (nextStateAfterStartWorkerUpgrade.action === 'stop') {\n                log({\n                    project: gameSettings.name,\n                    message: nextStateAfterStartWorkerUpgrade.action.message,\n                });\n                break;\n            }\n\n            states.push(nextStateAfterStartWorkerUpgrade);\n        }\n    }\n\n    const actions = _(states)\n        .map(state => state.actions)\n        .compact()\n        .flatten()\n        .value();\n    \n    if (actions.length === 0) {\n        return;\n    }\n    \n    return {\n        action: 'upgrade_workers',\n        isMultipleTransactions: true,\n        actions: _.chunk(actions, 16),\n    };\n};\n\nconst getFinishUpgradesAction = ({\n    accountName,\n    upgrades,\n}) => {\n    const now = Date.now();\n\n    const finishedUpgrades = _(upgrades)\n        .filter(upgrade => upgrade.owner === accountName)\n        .filter(upgrade => upgrade.endTime < now)\n        .value();\n\n    if (finishedUpgrades.length === 0) {\n        return;\n    }\n\n    return {\n        action: 'finish_upgrades',\n        actions: _(finishedUpgrades)\n            .map(upgrade => finishUpgrade({\n                accountName,\n                assetId: upgrade.assetId,\n            }))\n            .value(),\n    }\n};\n\n// -------------------------------------------------------- //\n// ---------             ENTRY POIN              ---------- //\n// -------------------------------------------------------- //\nconst playGameCalcNextAction = async ({\n    accountName,\n    gameSettings,\n}) => {\n    const economyValues = getEconomyValues();\n    const {\n        exchange,\n        account,\n        accountBuildings,\n        accountWorkers,\n        accountLands,\n        accountTransfers,\n        landConfigs,\n        upgradeConfigs,\n        upgrades,\n    } = await fetchAllGameData({\n        accountName,\n    });\n\n    // showing alert if some buildings places in district with inappropriate town hall level\n    if (accountBuildings.ownStaleBuildings.length > 0) {\n        const staleRealms = _(accountBuildings.ownStaleBuildings)\n            .map(building => building.district.realm.name)\n            .uniq()\n            .value();\n        log({\n            project: gameSettings.name,\n            message: `[ACTION NEEDED] ${accountBuildings.ownStaleBuildings.length} stale buildings, need to be moved to another district, relams: ${staleRealms.join(', ')}`,\n        });\n    }\n\n    // wake up all available workers\n    if (accountWorkers.readyToWakeupWorkers.length > 0) {\n        return {\n            action: 'wakeup',\n            actions: [\n                wakeupWorkers({\n                    accountName,\n                    workerIds: _(accountWorkers.readyToWakeupWorkers)\n                        .map(worker => worker.id)\n                        .value(),\n                }),\n            ],\n        };\n    }\n    \n    // set wage for all avaialbe buildings\n    if (accountBuildings.ownBuildingsWithoutWageSet.length > 0) {\n        return {\n            action: 'set_building_wage',\n            actions: _(accountBuildings.ownBuildingsWithoutWageSet)\n                .map(b => setBuildWage({\n                    accountName,\n                    id: b.id,\n                    wageObsd: b.config.minimumWage.obsdCost,\n                    isOnlyOwnWorkersAllowed: true,\n                    minWorkerLevel: 1,\n                }))\n                .value(),\n        };\n    }\n    \n    // prolong rent for buildings placed on your lands\n    if (accountBuildings.ownBuildingsExpiredExternalRentSet.length > 0) {\n        return {\n            action: 'cancel_external_rent',\n            actions: _(accountBuildings.ownBuildingsExpiredExternalRentSet)\n                .map(building => removeBuilding({\n                    accountName,\n                    buildingId: building.id,\n                }))\n                .value(),\n        };\n    }\n    const startMixedShiftsAction = getStartMixedShiftAction({\n        accountName,\n        exchange,\n        account,\n        buildings: accountBuildings.buildings,\n        workers: [\n            ...accountWorkers.readyToWorkWorkers,\n        ],\n        gameSettings,\n    });\n\n    const startMixedUnskilledShiftsAction = getStartMixedUnskilledShiftAction({\n        accountName,\n        exchange,\n        account,\n        buildings: accountBuildings.unskilledJobBuildings,\n        workers: accountWorkers.readyToWorkUnskilledWorkers,\n        gameSettings,\n    });\n\n    const startMixedUnskilledRestAction = getStartMixedUnskilledRestAction({\n        accountName,\n        exchange,\n        account,\n        buildings: accountBuildings.buildings,\n        workers: accountWorkers.readyToRestUnskilledWorkers,\n        gameSettings,\n    });\n    \n    const startMixedRestsAction = getStartMixedRestAction({\n        accountName,\n        exchange,\n        account,\n        buildings: accountBuildings.buildings,\n        workers: accountWorkers.readyToRestWorkers,\n        gameSettings,\n    });\n\n    const startRenewRentAction = getRenewRentAction({\n        accountName,\n        exchange,\n        account,\n        buildings: accountBuildings.ownBuildingsExpiredRentSet,\n        gameSettings,\n    });\n\n    const rentExternalLandsAction = getRentMixedLandsAction({\n        accountName,\n        exchange,\n        account,\n        lands: accountLands.lands,\n        buildings: accountTransfers.buildings,\n        landConfigs,\n        gameSettings,\n    });\n\n    const startWorkerUpgradesAction = getStartWorkerUpgradesAction({\n        account,\n        exchange,\n        accountName,\n        upgradeConfigs: upgradeConfigs.workers,\n        workers: accountWorkers.readyToUpgradeWorkers,\n        gameSettings,\n    });\n\n    const finishUpgradesAction = getFinishUpgradesAction({\n        accountName,\n        upgrades,\n    });\n\n    console.log(economyValues);\n    if (finishUpgradesAction != null) {\n        return finishUpgradesAction;\n    }\n\n    if (economyValues.ENABLE_WORKER_UPGRADES && startWorkerUpgradesAction != null) {\n        return startWorkerUpgradesAction;\n    }\n\n    if (economyValues.ENABLE_RENT_EXTERNAL_LANDS && rentExternalLandsAction != null) {\n        return rentExternalLandsAction;\n    }\n    \n    if (economyValues.ENABLE_REST_SKILLED_WORKERS && startMixedRestsAction != null) {\n        return startMixedRestsAction;\n    }\n\n    if (economyValues.ENABLE_REST_UNSKILLED_WORKERS && startMixedUnskilledRestAction != null) {\n        return startMixedUnskilledRestAction;\n    }\n    \n    if (economyValues.ENABLE_RENEW_RENT_LANDS && startRenewRentAction != null) {\n        return startRenewRentAction;\n    }\n\n    if (economyValues.ENABLE_SHIFT_SKILLED_WORKERS && startMixedShiftsAction != null) {\n        return startMixedShiftsAction;\n    }\n\n    if (economyValues.ENABLE_SHIFT_UNSKILLED_WORKERS && startMixedUnskilledShiftsAction != null) {\n        return startMixedUnskilledShiftsAction;\n    }\n\n    return {\n        action: 'wait',\n        message: `Nothing to do for ${accountName}`,\n    };\n};\n\nmodule.exports = playGameCalcNextAction;\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}